<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Southwest Airlines PTFS - Careers</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="navbar">
    <div class="container">
      <a href="/index.html">
        <img src="/images/branding/banner.png" alt="Southwest Airlines PTFS Logo" class="logo" onerror="this.src='https://via.placeholder.com/150x50?text=Logo+Not+Found'; this.onerror=null;" />
      </a>
      <nav class="nav-menu">
        <a href="https://discord.gg/ZGGu6fTrxE" target="_blank">Join</a>
        <a href="/index.html">Home</a>
        <a href="/book.html">Book</a>
        <a href="/checkin.html">Check In</a>
        <a href="/contact.html">Contact</a>
        <a href="/careers.html">Careers</a>
        <a href="/regulations.html">Regulations</a>
        <span id="auth-status">
          <a href="https://discord.com/oauth2/authorize?client_id=780288804836868118&response_type=code&redirect_uri=https%3A%2F%2Fapi.awdevsoftware.org%2Fauth%2Fdiscord%2Fcallback&scope=identify" id="login-link">Login with Discord</a>
          <span id="user-info" style="display: none;"></span>
          <a href="#" id="logout-link" style="display: none;">Logout</a>
        </span>
      </nav>
    </div>
  </header>

  <section class="careers-section">
    <div class="container">
      <h1>Join Our Team</h1>
      <div class="user-profile" id="user-profile" style="display: none;">
        <img id="user-avatar" src="" alt="User Avatar" class="user-avatar" />
        <p id="user-greeting"></p>
      </div>
      <p class="intro">Ready to soar with Southwest Airlines PTFS? We’re always looking for passionate individuals to join our crew!</p>
      <p>Join our Discord community to explore career opportunities, connect with our team, and learn more about working with us.</p>
      <a href="https://discord.gg/ZGGu6fTrxE" target="_blank" class="cta-button">Join Our Discord</a>
    </div>
  </section>

  <footer class="footer">
    <p>© 2025 Southwest Airlines PTFS. Not affiliated with Southwest Airlines.</p>
  </footer>

  <script src="/scripts/auth.js"></script>
  <script>
    const BACKEND_URL = 'http://localhost:3000';

    // Fetch and display user profile picture if logged in
    async function displayUserProfile() {
      try {
        const response = await fetch(`${BACKEND_URL}/auth/user`, { credentials: 'include' });
        if (response.ok) {
          const data = await response.json();
          const userProfile = document.getElementById('user-profile');
          const userAvatar = document.getElementById('user-avatar');
          const userGreeting = document.getElementById('user-greeting');

          // Construct Discord avatar URL
          const avatarUrl = `https://cdn.discordapp.com/avatars/${data.user.id}/${data.user.avatar}.png?size=128`;
          userAvatar.src = avatarUrl;
          userGreeting.textContent = `Welcome, ${data.user.username}! Ready to join our team?`;
          userProfile.style.display = 'block';

          // Handle avatar load error
          userAvatar.onerror = () => {
            userAvatar.src = 'https://via.placeholder.com/100?text=Avatar+Not+Found';
            userAvatar.onerror = null;
          };
        }
      } catch (error) {
        console.error('Error fetching user profile:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      displayUserProfile();
    });
  </script>
</body>
</html>